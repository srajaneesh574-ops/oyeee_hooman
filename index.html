<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Birthday Vault üéÇ</title>
    <style>
        body {
            background-color: #fff5f7; /* Berry/Pink background */
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 0;
            padding: 20px;
            text-align: center;
        }

        h1 { color: #ff85a1; margin-top: 20px; }
        #welcome-msg { color: #4a4a4a; margin-bottom: 30px; font-style: italic; font-size: 1.1rem; padding: 0 10px; }

        .vault-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            max-width: 350px;
        }

        .memory-box {
            width: 150px;
            height: 150px;
            background: white;
            border: 3px solid #ff85a1;
            border-radius: 20px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            box-shadow: 0 4px 10px rgba(255, 133, 161, 0.2);
            transition: 0.3s;
        }

        .memory-box:active { transform: scale(0.95); }
        .day-label { font-weight: bold; color: #ff85a1; font-size: 1.2rem; }
        .status-icon { font-size: 2rem; margin-top: 10px; }

        /* Video Modal Styles */
        #videoModal {
            display: none; 
            position: fixed; 
            top: 0; left: 0; 
            width: 100%; height: 100%; 
            background: rgba(0,0,0,0.9); 
            z-index: 100; 
            justify-content: center; 
            align-items: center; 
            flex-direction: column;
        }
        .modal-content {
            background: white; 
            padding: 15px; 
            border-radius: 20px; 
            width: 90%; 
            max-width: 360px; /* Slim for mobile */
            text-align: center;
            box-shadow: 0 0 20px rgba(255, 133, 161, 0.5);
        }
        video { 
            border-radius: 10px; 
            margin-top: 10px; 
            background: black; 
            max-height: 60vh; /* Keeps button visible below video */
            width: 100%;
            object-fit: contain;
        }
        .close-btn {
            display: none; /* Hidden until video ends üòÇüòÇ */
            margin-top: 15px; 
            background: #ff85a1; 
            color: white; 
            border: none; 
            padding: 12px 25px; 
            border-radius: 10px;
            cursor: pointer;
            font-weight: bold;
            width: 100%;
        }
    </style>
</head>
<body>

    <h1>The Memory Vault üíñ</h1>
    <p id="welcome-msg">Loading your journey...</p>

    <div class="vault-grid">
        </div>

    <div id="videoModal">
        <div class="modal-content">
            <h2 id="modalTitle" style="color:#ff85a1; margin: 0 0 10px 0; font-size: 1.2rem;"></h2>
            <video id="birthdayVideo" controls playsinline>
                <source id="videoSource" src="" type="video/mp4">
            </video>
            <button id="closeButton" class="close-btn" onclick="closeModal()">Close Memory üíñ</button>
        </div>
    </div>

    <script>
        const today = new Date().getDate();
        const currentMonth = new Date().getMonth(); // 0 = Jan
        const videoPlayer = document.getElementById('birthdayVideo');
        const closeBtn = document.getElementById('closeButton');

        // 1. Set Welcome Message
        const welcomeEl = document.getElementById('welcome-msg');
        if (currentMonth === 0) {
            if (today === 1) welcomeEl.innerText = "Something big is waiting at end of day 8! Unlock Day 1... üêß";
            else if (today < 8) welcomeEl.innerText = "Welcome back! You have " + today + " memories unlocked. üå∑";
            else welcomeEl.innerText = "Happy Birthday!! The final vault is ready! üéÇüéÜ";
        }

        // 2. Generate Grid
        const grid = document.querySelector('.vault-grid');
        for (let i = 1; i <= 8; i++) {
            const isUnlocked = (currentMonth === 0 && today >= i);
            const icon = isUnlocked ? "üéÅ" : "üîí";
            
            grid.innerHTML += `
                <div class="memory-box" onclick="checkLock(${i})">
                    <span class="day-label">Jan ${i}</span>
                    <div class="status-icon">${icon}</div>
                </div>
            `;
        }

        // 3. Close Button Logic: Appear only when video ends
        videoPlayer.onended = function() {
            closeBtn.style.display = "block";
        };

        // 4. Unlock/Play Logic
        function checkLock(day) {
            if (currentMonth === 0 && today >= day) {
                if (day === 8) {
                    window.location.href = "birthday.html"; 
                } else {
                    closeBtn.style.display = "none"; // Reset button visibility
                    document.getElementById('videoModal').style.display = 'flex';
                    document.getElementById('modalTitle').innerText = "Jan " + day + " Memory ‚ú®";
                    videoPlayer.src = "day" + day + ".mp4"; 
                    videoPlayer.load();
                    videoPlayer.play();
                }
            } else {
                alert("Patience, Penguin! üêß This box opens on Jan " + day);
            }
        }

        function closeModal() {
            videoPlayer.pause();
            document.getElementById('videoModal').style.display = 'none';
        }
    </script>
</body>
</html>